<!doctype html>
<html lang="id">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>DEVANTH APPS - Detektor Virus</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
    />
    <style>
      .glass {
        background: rgba(30, 41, 59, 0.7);
        backdrop-filter: blur(10px);
      }
    </style>
  </head>
  <body class="bg-[#0f172a] text-slate-200 min-h-screen font-sans">
    <div class="max-w-3xl mx-auto pt-16 px-6 pb-20">
      <div class="text-center mb-10">
        <div
          class="inline-block p-4 bg-blue-500/10 rounded-3xl mb-6 border border-blue-500/20 shadow-xl shadow-blue-500/5"
        >
          <i class="fas fa-shield-virus text-5xl text-blue-400"></i>
        </div>
        <h1 class="text-4xl font-extrabold text-white mb-3">DEVTH APPS</h1>
        <p class="text-slate-400 text-lg">
          Lindungi diri Anda dari Phishing Loker, Scam Telegram, dan Link
          Berbahaya.
        </p>
      </div>

      <div
        class="glass p-2 rounded-3xl border border-slate-700 shadow-2xl flex flex-col md:flex-row gap-2"
      >
        <input
          type="text"
          id="urlInput"
          placeholder="Tempel link di sini (https://...)"
          class="flex-1 p-5 bg-transparent border-none focus:ring-0 text-lg outline-none text-white"
        />
        <button
          onclick="mulaiScan()"
          id="btnScan"
          class="bg-blue-600 hover:bg-blue-500 px-10 py-4 rounded-2xl font-bold transition-all flex items-center justify-center shadow-lg active:scale-95"
        >
          <i class="fas fa-magnifying-glass mr-2"></i> Periksa Link
        </button>
      </div>

      <p class="text-center text-slate-500 text-xs mt-4">
        <i class="fas fa-info-circle mr-1"></i> Didukung oleh Database Keamanan
        VirusTotal (Google Cloud)
      </p>

      <div id="loading" class="hidden mt-12 text-center animate-pulse">
        <div class="inline-block animate-spin text-4xl text-blue-500 mb-3">
          <i class="fas fa-circle-notch"></i>
        </div>
        <p class="text-blue-400 font-medium">
          Sedang menganalisis keamanan link...
        </p>
      </div>

      <div
        id="resultBox"
        class="hidden mt-12 p-8 rounded-[2rem] border-2 transition-all duration-500 shadow-2xl"
      >
        <div class="flex items-start gap-6">
          <div id="resIcon" class="text-6xl"></div>
          <div class="flex-1">
            <h2 id="resTitle" class="text-2xl font-bold mb-1"></h2>
            <p id="resSub" class="text-slate-300 mb-4"></p>
            <div class="grid grid-cols-2 gap-3 mt-4">
              <div class="bg-black/20 p-3 rounded-xl border border-white/5">
                <span class="block text-xs text-slate-500 uppercase"
                  >Vendor Scan</span
                >
                <span id="statScan" class="text-lg font-bold">0</span>
              </div>
              <div class="bg-black/20 p-3 rounded-xl border border-white/5">
                <span class="block text-xs text-slate-500 uppercase"
                  >Status</span
                >
                <span id="statStatus" class="text-lg font-bold">-</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <footer
      class="fixed bottom-0 w-full p-6 text-center border-t border-slate-800 bg-[#0f172a]/80 backdrop-blur-md"
    >
      <p class="text-slate-500 text-sm italic">
        "Keamanan Anda adalah kunci (by Devanth)."
      </p>
    </footer>

    <script>
      // API Key VirusTotal milik Anda
      const API_KEY =
        "f67fd6de8f45c8764fa9bf02e0c1d279f17b8552549267963f49d12e8ab7ee58";

      async function mulaiScan() {
        const urlInput = document.getElementById("urlInput").value.trim();
        const btn = document.getElementById("btnScan");
        const loading = document.getElementById("loading");
        const resultBox = document.getElementById("resultBox");

        if (!urlInput) return alert("Silakan tempel URL terlebih dahulu!");
        if (!urlInput.startsWith("http"))
          return alert("URL harus diawali dengan http:// atau https://");

        // UI Reset
        loading.classList.remove("hidden");
        resultBox.classList.add("hidden");
        btn.disabled = true;
        btn.classList.add("opacity-50");

        try {
          // Step 1: Kirim URL untuk dianalisis
          const response = await fetch(
            "https://www.virustotal.com/api/v3/urls",
            {
              method: "POST",
              headers: {
                "x-apikey": API_KEY,
                "Content-Type": "application/x-www-form-urlencoded",
              },
              body: new URLSearchParams({ url: urlInput }),
            },
          );

          const data = await response.json();
          if (data.error) throw new Error(data.error.message);

          const analysisId = data.data.id;

          // Step 2: Ambil Hasil (Delay 3 detik agar server selesai memproses)
          setTimeout(async () => {
            const checkRes = await fetch(
              `https://www.virustotal.com/api/v3/analyses/${analysisId}`,
              {
                headers: { "x-apikey": API_KEY },
              },
            );
            const finalData = await checkRes.json();
            tampilkanHasil(finalData.data.attributes.stats);

            loading.classList.add("hidden");
            btn.disabled = false;
            btn.classList.remove("opacity-50");
          }, 3000);
        } catch (err) {
          alert("Kesalahan API: " + err.message);
          loading.classList.add("hidden");
          btn.disabled = false;
          btn.classList.remove("opacity-50");
        }
      }

      function tampilkanHasil(stats) {
        const box = document.getElementById("resultBox");
        const icon = document.getElementById("resIcon");
        const title = document.getElementById("resTitle");
        const sub = document.getElementById("resSub");
        const statScan = document.getElementById("statScan");
        const statStatus = document.getElementById("statStatus");

        box.classList.remove("hidden");
        const totalBahaya = stats.malicious + stats.phishing + stats.suspicious;

        if (totalBahaya > 0) {
          // Tampilan Bahaya
          box.className =
            "mt-12 p-8 rounded-[2rem] border-2 border-red-500 bg-red-500/10 shadow-[0_0_50px_-12px_rgba(239,68,68,0.3)]";
          icon.innerHTML = "üö®";
          title.innerText = "LINK BERBAHAYA!";
          title.className = "text-2xl font-bold mb-1 text-red-500";
          sub.innerText =
            "Sangat disarankan untuk TIDAK membuka link ini karena terindikasi penipuan atau malware.";
          statStatus.innerText = "MALICIOUS";
          statStatus.className = "text-lg font-bold text-red-500";
        } else {
          // Tampilan Aman
          box.className =
            "mt-12 p-8 rounded-[2rem] border-2 border-green-500 bg-green-500/10 shadow-[0_0_50px_-12px_rgba(34,197,94,0.3)]";
          icon.innerHTML = "üõ°Ô∏è";
          title.innerText = "LINK AMAN";
          title.className = "text-2xl font-bold mb-1 text-green-500";
          sub.innerText =
            "Berdasarkan hasil pemindaian 70+ vendor keamanan, link ini tidak ditemukan ancaman.";
          statStatus.innerText = "CLEAN";
          statStatus.className = "text-lg font-bold text-green-500";
        }
        statScan.innerText = stats.harmless + stats.undetected;
      }
    </script>
  </body>
</html>
